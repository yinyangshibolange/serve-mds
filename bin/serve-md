#!/usr/bin/env node

const path = require("path")
const chalk = require("chalk")
// const yargs = require("yargs")
const pkg = require('../package.json'); 
const fs = require("fs")


require('yargonaut')
.help('3D-ASCII')
.helpStyle('green')
  .style('blue')
 
var argv = require('yargs')
  .command('add', 'Add item to cart')
  .command('rm', 'Remove item from cart')
  .option('p', {
    alias: 'port',
    describe: 'service listening port',
    demand: true,
  })
  .option('s', {
    alias: 'staticfold',
    describe: 'static fold,bind to server',
  })
  .option('c', {
    alias: 'color',
    describe: 'Desired product color'
  })
  .example('$0 add -p 123 -s l -c green', 'Add large, green product with id 123')
  .wrap(null)
  .argv


  console.log(argv.port)

  // console.log(require("serve-md.config.js"))

  const userspace_path = process.cwd()

  console.log(__dirname, __filename)
  console.log("cwd path: "+ userspace_path)
  console.log(path.resolve(userspace_path, "serve-md.config.js"))
  console.log('process.execPath', process.execPath)

  fs.stat(path.resolve(userspace_path, "serve-md.config.js"), (err, stat) => {
   let config = require("./config")
   if(!err && stat.isFile()) {
    config = Object.assign(config, require(path.resolve(userspace_path, "serve-md.config.js")))
   }
   require(path.resolve(__dirname, "../lib/index"))(config)
  })


//   process.cwd() 执行命令时所在的目录
// __dirname 该js文件所在的目录
// process.execPath 执行此js脚本所用的nodejs程序文件路径